<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Resampling (sinc Interpolation) · FourierTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FourierTools.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">FourierTools.jl</a></li><li><a class="tocitem" href="../helpers/">FFT Helpers</a></li><li><a class="tocitem" href="../convolutions/">FFT Based Convolutions and Cross-Correlation</a></li><li class="is-active"><a class="tocitem" href>Resampling (sinc Interpolation)</a><ul class="internal"><li><a class="tocitem" href="#Sinc-interpolation"><span>Sinc interpolation</span></a></li><li><a class="tocitem" href="#Downsampling"><span>Downsampling</span></a></li><li><a class="tocitem" href="#Image-Upsampling"><span>Image Upsampling</span></a></li><li><a class="tocitem" href="#Function-References"><span>Function References</span></a></li></ul></li><li><a class="tocitem" href="../shifting/">Shifting with FFTs</a></li><li><a class="tocitem" href="../shear/">Image Shearing with FFTs</a></li><li><a class="tocitem" href="../rotate/">Image Rotation with FFTs</a></li><li><a class="tocitem" href="../utils/">Utility Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Resampling (sinc Interpolation)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Resampling (sinc Interpolation)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bionanoimaging/FourierTools.jl/blob/main/docs/src/resampling.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Resampling"><a class="docs-heading-anchor" href="#Resampling">Resampling</a><a id="Resampling-1"></a><a class="docs-heading-anchor-permalink" href="#Resampling" title="Permalink"></a></h1><p>To sinc interpolate a signal, it is possible to zero pad a signal in Fourier space and to do an inverse Fourier transform effectively evaluating the Fourier series at more samples. If the signal was initially band-limited, sinc interpolation leads to smoother, perfectly interpolated signals</p><h2 id="Sinc-interpolation"><a class="docs-heading-anchor" href="#Sinc-interpolation">Sinc interpolation</a><a id="Sinc-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Sinc-interpolation" title="Permalink"></a></h2><p>Below you can find a simple example for up sampling using <code>resample</code>.  Furthermore, there is an image interpolation <a href="https://github.com/fonsp/Pluto.jl">Pluto.jl</a> notebook in the <a href="https://github.com/bionanoimaging/FourierTools.jl/tree/main/examples/">examples folder</a>. We can see that the interpolated signal matches the higher sampled signal well.</p><pre><code class="language-julia hljs"> begin
	N_low = 128
	x_min = 0.0
	x_max = 16π
	
	xs_low = range(x_min, x_max, length=N_low+1)[1:N_low]
	xs_high = range(x_min, x_max, length=5000)[1:end-1]
	f(x) = sin(0.5*x) + cos(x) + cos(2 * x) + sin(0.25*x)
	arr_low = f.(xs_low)
	arr_high = f.(xs_high)
end

begin
	N = 1000
	xs_interp = range(x_min, x_max, length=N+1)[1:N]
	arr_interp = resample(arr_low, N)
end

begin
	scatter(xs_low, arr_low, legend=:bottomleft, markersize=2, label=&quot;Low sampling&quot;)
	plot!(xs_interp, arr_interp, label=&quot;FFT based sinc interpolation&quot;, linestyle=:dash)
	plot!(xs_high, arr_high, linestyle=:dashdotdot, label=&quot;High sampling&quot;)
end</code></pre><p><img src="../assets/1D_resample.png" alt/></p><h2 id="Downsampling"><a class="docs-heading-anchor" href="#Downsampling">Downsampling</a><a id="Downsampling-1"></a><a class="docs-heading-anchor-permalink" href="#Downsampling" title="Permalink"></a></h2><p>32 samples in the downsampled signal should be sufficient for Nyquist sampling. And as we can see, the downsampled signal still matches the original one.</p><pre><code class="language-julia hljs">begin
	N_ds = 32
	xs_ds = range(x_min, x_max, length=N_ds+1)[1:N_ds]
	arr_ds = resample(arr_high, N_ds)
end

begin
	scatter(xs_low, arr_low, legend=:bottomleft, markersize=2, label=&quot;Low sampling&quot;)
	plot!(xs_interp, arr_interp, label=&quot;FFT based sinc interpolation&quot;, linestyle=:dash)
	plot!(xs_ds, arr_ds, label=&quot;resampled array&quot;, linestyle=:dot)	
end</code></pre><p><img src="../assets/plot_ds.png" alt/></p><h2 id="Image-Upsampling"><a class="docs-heading-anchor" href="#Image-Upsampling">Image Upsampling</a><a id="Image-Upsampling-1"></a><a class="docs-heading-anchor-permalink" href="#Image-Upsampling" title="Permalink"></a></h2><p>Having a Nyquist sampled image, it is possible to perform a sinc interpolation and creating visually much nicer images. However, the information content does not change between both images. The full Pluto notebook is <a href="https://github.com/bionanoimaging/FourierTools.jl/tree/main/examples/resample_image.jl">here</a>. The right image is the upsampled version of the left one.</p><p><img src="../assets/image_low_res.png" alt/> <img src="../assets/image_high_res.png" alt/></p><h2 id="Function-References"><a class="docs-heading-anchor" href="#Function-References">Function References</a><a id="Function-References-1"></a><a class="docs-heading-anchor-permalink" href="#Function-References" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="FourierTools.resample" href="#FourierTools.resample"><code>FourierTools.resample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">resample(arr, new_size [, normalize=true])</code></pre><p>Calculates the <code>sinc</code> interpolation of an <code>arr</code> on a new array size <code>new_size</code>. It is a re-evaluation of the Fourier series at new grid points. <code>new_size</code> can be arbitrary. Each dimension is then independently either up or downsampled.</p><p>This method is based on FFTs and therefore implicitly assumes periodic boundaries and a finite frequency support.</p><p><code>normalize=true</code> by default multiplies by an appropriate factor so that the array size is included in the scaling. This results in an array having roughly the same mean intensity.</p><p><strong>Basic Principle</strong></p><p>If <code>size(new_size)[i] &gt; size(arr)[i]</code>, we apply zero padding in Fourier space.</p><p>If <code>size(new_size)[i] &lt; size(arr)[i]</code>, we cut out a centered part of the Fourier spectrum.</p><p>We apply some tricks at the boundary to increase accuracy of highest frequencies. </p><p>For real arrays we use <code>rfft</code> based operations, for complex one we use <code>fft</code> based ones.</p><p><strong>Examples</strong></p><p>sinc interpolation of 2 datapoints result in an approximation of cosine.</p><pre><code class="language-julia-repl hljs">julia&gt; resample([2.0, 0.0], (6,))
6-element Vector{Float64}:
 2.0
 1.5
 0.5
 0.0
 0.5
 1.5

julia&gt; resample([2.0, 0.0], (6,)) ≈ 1 .+ cos.(2π .* (0:5)./6)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/FourierTools.jl/blob/c01687d1aa81ef015d2c8238c0f7b95960691d75/src/resampling.jl#L12-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FourierTools.upsample2" href="#FourierTools.upsample2"><code>FourierTools.upsample2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">upsample2(mat::AbstractArray{T, N}; dims=1:N, fix_center=false, keep_singleton=false)</code></pre><p>Upsamples by a factor of two in all dimensions.  The code is optimized for speed by using subpixelshifts rather than Fourier resizing. By default the first pixel maintains its position. However, this leads to a shift of the center (size[d]÷2+1) in the resulting array for  uneven array sizes. <code>fix_center=true</code> can be used to remedy this and the result array center position will agree to the source array center position. <code>keep_singleton=true</code> will not upsample dimensions of size one. Note that upsample2 is based on Fourier-shifting and you may have to deal with wrap-around problems. ```jdoctest julia&gt; upsample2(collect(collect(1.0:9.0)&#39;)) 2×18 Matrix{Float64}:  1.0  0.24123  2.0  3.24123  3.0  2.93582  4.0  5.0  5.0  5.0  6.0  7.06418  7.0  6.75877  8.0  9.75877  9.0  5.0  1.0  0.24123  2.0  3.24123  3.0  2.93582  4.0  5.0  5.0  5.0  6.0  7.06418  7.0  6.75877  8.0  9.75877  9.0  5.0</p><p>julia&gt; upsample2(collect(collect(1.0:9.0)&#39;); fix<em>center=true, keep</em>singleton=true) 1×18 Matrix{Float64}:  5.0  1.0  0.24123  2.0  3.24123  3.0  2.93582  4.0  5.0  5.0  5.0  6.0  7.06418  7.0  6.75877  8.0  9.75877  9.0  ```</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/FourierTools.jl/blob/c01687d1aa81ef015d2c8238c0f7b95960691d75/src/resampling.jl#L132-L151">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../convolutions/">« FFT Based Convolutions and Cross-Correlation</a><a class="docs-footer-nextpage" href="../shifting/">Shifting with FFTs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 12 August 2022 11:24">Friday 12 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
